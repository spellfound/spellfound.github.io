{"ast":null,"code":"import _defineProperty from\"/Users/kristjanjonsson/Projects/spellfound/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/kristjanjonsson/Projects/spellfound/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/kristjanjonsson/Projects/spellfound/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/kristjanjonsson/Projects/spellfound/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/kristjanjonsson/Projects/spellfound/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/kristjanjonsson/Projects/spellfound/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import'./Spellfound.css';var match=function match(letters,facit){var m=true;facit.map(function(f){if(letters[f.model.toUpperCase()]&&letters[f.model.toUpperCase()].toUpperCase()!==f.value.toUpperCase()){m=false;}return 0;});return m;};var Spellfound=/*#__PURE__*/function(_React$Component){_inherits(Spellfound,_React$Component);var _super=_createSuper(Spellfound);function Spellfound(props){var _this;_classCallCheck(this,Spellfound);_this=_super.call(this,props);_this.state={letters:{},facit:{},matrix:[],typeDown:false,puzzle:props.puzzle};_this.handleChange=_this.handleChange.bind(_assertThisInitialized(_this));_this.handleSubmit=_this.handleSubmit.bind(_assertThisInitialized(_this));_this.handleArrowKey=_this.handleArrowKey.bind(_assertThisInitialized(_this));_this.handleFocus=_this.handleFocus.bind(_assertThisInitialized(_this));_this.handleFileSelect=_this.handleFileSelect.bind(_assertThisInitialized(_this));_this.loadJson=_this.loadJson.bind(_assertThisInitialized(_this));return _this;}_createClass(Spellfound,[{key:\"handleChange\",value:function handleChange(e){if(e!==undefined){var upperCase=e.target.value.toUpperCase();this.setState(_defineProperty({},e.target.name,upperCase));this.state.letters[e.target.name]=upperCase;if(e.target.className.includes('rightdown')){this.setState({typeDown:true});this.moveFocus(this.nextIdDown(e.target.id));return;}if(e.target.className.includes('downright')){this.setState({typeDown:false});this.moveFocus(this.nextIdRight(e.target.id));return;}if(this.state.typeDown){this.moveFocus(this.nextIdDown(e.target.id));}else{this.moveFocus(this.nextIdRight(e.target.id));}}}},{key:\"moveFocus\",value:function moveFocus(nextid){if(document.getElementById(nextid)!==null){document.getElementById(nextid).focus();}}},{key:\"nextIdRight\",value:function nextIdRight(id){return id.substr(0,3)+(parseInt(id.substr(3,2),10)+1).toString().padStart(2,\"0\");}},{key:\"nextIdLeft\",value:function nextIdLeft(id){return id.substr(0,3)+(parseInt(id.substr(3,2),10)-1).toString().padStart(2,\"0\");}},{key:\"nextIdUp\",value:function nextIdUp(id){return id.substr(0,1)+(parseInt(id.substr(1,2),10)-1).toString().padStart(2,\"0\")+id.substr(3,2);}},{key:\"nextIdDown\",value:function nextIdDown(id){return id.substr(0,1)+(parseInt(id.substr(1,2),10)+1).toString().padStart(2,\"0\")+id.substr(3,2);}},{key:\"handleArrowKey\",value:function handleArrowKey(e){var nextid;switch(e.key){case'ArrowUp':nextid=this.nextIdUp(e.target.id);this.setState({typeDown:true});break;case'ArrowDown':nextid=this.nextIdDown(e.target.id);this.setState({typeDown:true});break;case'ArrowLeft':nextid=this.nextIdLeft(e.target.id);this.setState({typeDown:false});break;case'ArrowRight':nextid=this.nextIdRight(e.target.id);this.setState({typeDown:false});break;}this.moveFocus(nextid);}},{key:\"handleFileSelect\",value:function handleFileSelect(evt){if(evt){var files=evt.target.files;if(!files.length){alert('No file select');return;}var file=files[0];var reader=new FileReader();var that=this;reader.onload=function(e){that.loadJson(JSON.parse(e.target.result));};reader.readAsText(file);}}},{key:\"loadJson\",value:function loadJson(json){this.setState({matrix:json.matrix,facit:json.facit,title:json.title,legend:json.legend});}},{key:\"handleSubmit\",value:function handleSubmit(event){if(match(this.state.letters,this.state.facit)){alert('Correct!');}else{alert('Needs more work!');}event.preventDefault();}},{key:\"handleFocus\",value:function handleFocus(e){e.target.select();}},{key:\"render\",value:function render(){var _this2=this;var rowId=0;var matrixTab=this.state.matrix.map(function(rad){++rowId;var colId=0;return/*#__PURE__*/React.createElement(\"tr\",{key:rowId},rad.map(function(cell){++colId;var sqrId=\"i\"+rowId.toString().padStart(2,\"0\")+colId.toString().padStart(2,\"0\");var sqrClass=\"sqr \"+(cell.class!==undefined?cell.class:\"\");return/*#__PURE__*/React.createElement(\"td\",{key:sqrId},/*#__PURE__*/React.createElement(\"input\",{id:sqrId,disabled:_this2.getDisabled(cell),className:sqrClass,type:\"text\",size:\"1\",maxLength:\"1\",required:true,style:_this2.getDisabled(cell)?{visibility:'hidden'}:{backgroundColor:'ivory'},name:cell.model,value:_this2.state.letters[cell.model],onChange:_this2.handleChange,onKeyUp:_this2.handleArrowKey,onFocus:_this2.handleFocus}));}));});return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"title\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"inputfilnamn\",className:\"btn\"},\"L\\xE4s in:\\xA0\"),/*#__PURE__*/React.createElement(\"input\",{type:\"file\",id:\"inputfilnamn\",name:\"inputfilnamn\",onChange:this.handleFileSelect})),/*#__PURE__*/React.createElement(\"h2\",{className:\"title\"},this.state.title),/*#__PURE__*/React.createElement(\"div\",{className:\"component\"},/*#__PURE__*/React.createElement(\"form\",{onSubmit:this.handleSubmit},/*#__PURE__*/React.createElement(\"table\",null,/*#__PURE__*/React.createElement(\"tbody\",null,matrixTab)),/*#__PURE__*/React.createElement(\"div\",{className:\"verify\"},/*#__PURE__*/React.createElement(\"input\",{type:\"submit\",value:\"Kontrollera\"})))),/*#__PURE__*/React.createElement(\"div\",{className:\"legend\"},/*#__PURE__*/React.createElement(\"p\",null,this.state.legend)));}},{key:\"getDisabled\",value:function getDisabled(cell){return cell.model==='';}},{key:\"componentDidMount\",value:function componentDidMount(){var _this3=this;return fetch('http://spellbuildboot-env.eba-vhu9appg.eu-north-1.elasticbeanstalk.com/store/'+this.state.puzzle,{mode:'no-cors'}).then(function(response){return response.json();}).then(function(json){_this3.setState({matrix:json.matrix,facit:json.facit,title:json.title,legend:json.legend});}).catch(function(error){console.error(error);});}}]);return Spellfound;}(React.Component);export default Spellfound;","map":{"version":3,"sources":["/Users/kristjanjonsson/Projects/spellfound/src/Spellfound.js"],"names":["React","match","letters","facit","m","map","f","model","toUpperCase","value","Spellfound","props","state","matrix","typeDown","puzzle","handleChange","bind","handleSubmit","handleArrowKey","handleFocus","handleFileSelect","loadJson","e","undefined","upperCase","target","setState","name","className","includes","moveFocus","nextIdDown","id","nextIdRight","nextid","document","getElementById","focus","substr","parseInt","toString","padStart","key","nextIdUp","nextIdLeft","evt","files","length","alert","file","reader","FileReader","that","onload","JSON","parse","result","readAsText","json","title","legend","event","preventDefault","select","rowId","matrixTab","rad","colId","cell","sqrId","sqrClass","class","getDisabled","visibility","backgroundColor","fetch","mode","then","response","catch","error","console","Component"],"mappings":"w8BAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAO,kBAAP,CAEA,GAAMC,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,CAACC,OAAD,CAAUC,KAAV,CAAoB,CACjC,GAAIC,CAAAA,CAAC,CAAG,IAAR,CACAD,KAAK,CAACE,GAAN,CAAU,SAAAC,CAAC,CAAI,CACd,GAAIJ,OAAO,CAACI,CAAC,CAACC,KAAF,CAAQC,WAAR,EAAD,CAAP,EAAkCN,OAAO,CAACI,CAAC,CAACC,KAAF,CAAQC,WAAR,EAAD,CAAP,CAA+BA,WAA/B,KAAiDF,CAAC,CAACG,KAAF,CAAQD,WAAR,EAAvF,CAA8G,CAC7GJ,CAAC,CAAG,KAAJ,CACA,CACD,MAAO,EAAP,CACA,CALD,EAMA,MAAOA,CAAAA,CAAP,CACA,CATD,C,GAWMM,CAAAA,U,oHACL,oBAAYC,KAAZ,CAAmB,4CAClB,uBAAMA,KAAN,EACA,MAAKC,KAAL,CAAa,CACZV,OAAO,CAAG,EADE,CACEC,KAAK,CAAG,EADV,CAEZU,MAAM,CAAG,EAFG,CAGZC,QAAQ,CAAG,KAHC,CAIZC,MAAM,CAAGJ,KAAK,CAACI,MAJH,CAAb,CAOA,MAAKC,YAAL,CAAoB,MAAKA,YAAL,CAAkBC,IAAlB,+BAApB,CACA,MAAKC,YAAL,CAAoB,MAAKA,YAAL,CAAkBD,IAAlB,+BAApB,CACA,MAAKE,cAAL,CAAsB,MAAKA,cAAL,CAAoBF,IAApB,+BAAtB,CACA,MAAKG,WAAL,CAAmB,MAAKA,WAAL,CAAiBH,IAAjB,+BAAnB,CACA,MAAKI,gBAAL,CAAwB,MAAKA,gBAAL,CAAsBJ,IAAtB,+BAAxB,CACA,MAAKK,QAAL,CAAgB,MAAKA,QAAL,CAAcL,IAAd,+BAAhB,CAdkB,aAelB,C,yEAEYM,C,CAAG,CACf,GAAIA,CAAC,GAAKC,SAAV,CAAqB,CACpB,GAAIC,CAAAA,SAAS,CAAGF,CAAC,CAACG,MAAF,CAASjB,KAAT,CAAeD,WAAf,EAAhB,CACA,KAAKmB,QAAL,oBACEJ,CAAC,CAACG,MAAF,CAASE,IADX,CACmBH,SADnB,GAGA,KAAKb,KAAL,CAAWV,OAAX,CAAmBqB,CAAC,CAACG,MAAF,CAASE,IAA5B,EAAoCH,SAApC,CACA,GAAIF,CAAC,CAACG,MAAF,CAASG,SAAT,CAAmBC,QAAnB,CAA4B,WAA5B,CAAJ,CAA8C,CAC7C,KAAKH,QAAL,CAAc,CAACb,QAAQ,CAAG,IAAZ,CAAd,EACA,KAAKiB,SAAL,CAAe,KAAKC,UAAL,CAAgBT,CAAC,CAACG,MAAF,CAASO,EAAzB,CAAf,EACA,OACA,CACD,GAAIV,CAAC,CAACG,MAAF,CAASG,SAAT,CAAmBC,QAAnB,CAA4B,WAA5B,CAAJ,CAA8C,CAC7C,KAAKH,QAAL,CAAc,CAACb,QAAQ,CAAG,KAAZ,CAAd,EACA,KAAKiB,SAAL,CAAe,KAAKG,WAAL,CAAiBX,CAAC,CAACG,MAAF,CAASO,EAA1B,CAAf,EACA,OACA,CACD,GAAI,KAAKrB,KAAL,CAAWE,QAAf,CAAyB,CACxB,KAAKiB,SAAL,CAAe,KAAKC,UAAL,CAAgBT,CAAC,CAACG,MAAF,CAASO,EAAzB,CAAf,EACA,CAFD,IAEO,CACN,KAAKF,SAAL,CAAe,KAAKG,WAAL,CAAiBX,CAAC,CAACG,MAAF,CAASO,EAA1B,CAAf,EACA,CACD,CACD,C,4CAESE,M,CAAQ,CACjB,GAAIC,QAAQ,CAACC,cAAT,CAAwBF,MAAxB,IAAoC,IAAxC,CAA8C,CAC7CC,QAAQ,CAACC,cAAT,CAAwBF,MAAxB,EAAgCG,KAAhC,GACA,CACD,C,gDAEWL,E,CAAI,CACf,MAAOA,CAAAA,EAAE,CAACM,MAAH,CAAU,CAAV,CAAa,CAAb,EAAkB,CAACC,QAAQ,CAACP,EAAE,CAACM,MAAH,CAAU,CAAV,CAAa,CAAb,CAAD,CAAkB,EAAlB,CAAR,CAAgC,CAAjC,EAAoCE,QAApC,GAA+CC,QAA/C,CAAwD,CAAxD,CAA2D,GAA3D,CAAzB,CACA,C,8CACUT,E,CAAI,CACd,MAAOA,CAAAA,EAAE,CAACM,MAAH,CAAU,CAAV,CAAa,CAAb,EAAkB,CAACC,QAAQ,CAACP,EAAE,CAACM,MAAH,CAAU,CAAV,CAAa,CAAb,CAAD,CAAkB,EAAlB,CAAR,CAAgC,CAAjC,EAAoCE,QAApC,GAA+CC,QAA/C,CAAwD,CAAxD,CAA2D,GAA3D,CAAzB,CACA,C,0CACQT,E,CAAI,CACZ,MAAOA,CAAAA,EAAE,CAACM,MAAH,CAAU,CAAV,CAAa,CAAb,EAAkB,CAACC,QAAQ,CAACP,EAAE,CAACM,MAAH,CAAU,CAAV,CAAa,CAAb,CAAD,CAAkB,EAAlB,CAAR,CAAgC,CAAjC,EAAoCE,QAApC,GAA+CC,QAA/C,CAAwD,CAAxD,CAA2D,GAA3D,CAAlB,CAAoFT,EAAE,CAACM,MAAH,CAAU,CAAV,CAAa,CAAb,CAA3F,CACA,C,8CACUN,E,CAAI,CACd,MAAOA,CAAAA,EAAE,CAACM,MAAH,CAAU,CAAV,CAAa,CAAb,EAAkB,CAACC,QAAQ,CAACP,EAAE,CAACM,MAAH,CAAU,CAAV,CAAa,CAAb,CAAD,CAAkB,EAAlB,CAAR,CAAgC,CAAjC,EAAoCE,QAApC,GAA+CC,QAA/C,CAAwD,CAAxD,CAA2D,GAA3D,CAAlB,CAAoFT,EAAE,CAACM,MAAH,CAAU,CAAV,CAAa,CAAb,CAA3F,CACA,C,sDAEehB,C,CAAG,CAClB,GAAIY,CAAAA,MAAJ,CACA,OAAQZ,CAAC,CAACoB,GAAV,EACC,IAAK,SAAL,CACCR,MAAM,CAAG,KAAKS,QAAL,CAAcrB,CAAC,CAACG,MAAF,CAASO,EAAvB,CAAT,CACA,KAAKN,QAAL,CAAc,CAACb,QAAQ,CAAG,IAAZ,CAAd,EACA,MACD,IAAK,WAAL,CACCqB,MAAM,CAAG,KAAKH,UAAL,CAAgBT,CAAC,CAACG,MAAF,CAASO,EAAzB,CAAT,CACA,KAAKN,QAAL,CAAc,CAACb,QAAQ,CAAG,IAAZ,CAAd,EACA,MACD,IAAK,WAAL,CACCqB,MAAM,CAAG,KAAKU,UAAL,CAAgBtB,CAAC,CAACG,MAAF,CAASO,EAAzB,CAAT,CACA,KAAKN,QAAL,CAAc,CAACb,QAAQ,CAAG,KAAZ,CAAd,EACA,MACD,IAAK,YAAL,CACCqB,MAAM,CAAG,KAAKD,WAAL,CAAiBX,CAAC,CAACG,MAAF,CAASO,EAA1B,CAAT,CACA,KAAKN,QAAL,CAAc,CAACb,QAAQ,CAAG,KAAZ,CAAd,EACA,MAhBF,CAkBA,KAAKiB,SAAL,CAAeI,MAAf,EACA,C,0DAEgBW,G,CAAK,CACrB,GAAIA,GAAJ,CAAS,CACR,GAAIC,CAAAA,KAAK,CAAGD,GAAG,CAACpB,MAAJ,CAAWqB,KAAvB,CACA,GAAI,CAACA,KAAK,CAACC,MAAX,CAAmB,CAClBC,KAAK,CAAC,gBAAD,CAAL,CACA,OACA,CACD,GAAIC,CAAAA,IAAI,CAAGH,KAAK,CAAC,CAAD,CAAhB,CACA,GAAII,CAAAA,MAAM,CAAG,GAAIC,CAAAA,UAAJ,EAAb,CACA,GAAIC,CAAAA,IAAI,CAAG,IAAX,CACAF,MAAM,CAACG,MAAP,CAAgB,SAAU/B,CAAV,CAAa,CAC5B8B,IAAI,CAAC/B,QAAL,CAAciC,IAAI,CAACC,KAAL,CAAWjC,CAAC,CAACG,MAAF,CAAS+B,MAApB,CAAd,EACA,CAFD,CAGAN,MAAM,CAACO,UAAP,CAAkBR,IAAlB,EACA,CACD,C,0CAEQS,I,CAAM,CACd,KAAKhC,QAAL,CAAc,CAACd,MAAM,CAAG8C,IAAI,CAAC9C,MAAf,CAAuBV,KAAK,CAAGwD,IAAI,CAACxD,KAApC,CAA2CyD,KAAK,CAAGD,IAAI,CAACC,KAAxD,CAA+DC,MAAM,CAAGF,IAAI,CAACE,MAA7E,CAAd,EACA,C,kDAEYC,K,CAAO,CACnB,GAAI7D,KAAK,CAAC,KAAKW,KAAL,CAAWV,OAAZ,CAAqB,KAAKU,KAAL,CAAWT,KAAhC,CAAT,CAAiD,CAChD8C,KAAK,CAAC,UAAD,CAAL,CACA,CAFD,IAEO,CACNA,KAAK,CAAC,kBAAD,CAAL,CACA,CACDa,KAAK,CAACC,cAAN,GACA,C,gDAEWxC,C,CAAG,CACdA,CAAC,CAACG,MAAF,CAASsC,MAAT,GACA,C,uCAEQ,iBACR,GAAIC,CAAAA,KAAK,CAAG,CAAZ,CACA,GAAMC,CAAAA,SAAS,CAAG,KAAKtD,KAAL,CAAWC,MAAX,CAAkBR,GAAlB,CAAsB,SAAA8D,GAAG,CAAI,CAC9C,EAAEF,KAAF,CACA,GAAIG,CAAAA,KAAK,CAAG,CAAZ,CACA,mBAAQ,0BAAI,GAAG,CAAEH,KAAT,EACLE,GAAG,CAAC9D,GAAJ,CAAQ,SAAAgE,IAAI,CAAI,CAChB,EAAED,KAAF,CACA,GAAIE,CAAAA,KAAK,CAAG,IAAML,KAAK,CAACxB,QAAN,GAAiBC,QAAjB,CAA0B,CAA1B,CAA6B,GAA7B,CAAN,CAA0C0B,KAAK,CAAC3B,QAAN,GAAiBC,QAAjB,CAA0B,CAA1B,CAA6B,GAA7B,CAAtD,CACA,GAAI6B,CAAAA,QAAQ,CAAG,QAAWF,IAAI,CAACG,KAAL,GAAehD,SAAhB,CAA6B6C,IAAI,CAACG,KAAlC,CAA0C,EAApD,CAAf,CACA,mBAAQ,0BAAI,GAAG,CAAEF,KAAT,eACP,6BAAO,EAAE,CAAEA,KAAX,CACI,QAAQ,CAAE,MAAI,CAACG,WAAL,CAAiBJ,IAAjB,CADd,CACsC,SAAS,CAAEE,QADjD,CAC2D,IAAI,CAAC,MADhE,CACuE,IAAI,CAAC,GAD5E,CACgF,SAAS,CAAC,GAD1F,CAC8F,QAAQ,KADtG,CAEI,KAAK,CAAE,MAAI,CAACE,WAAL,CAAiBJ,IAAjB,EAAyB,CAACK,UAAU,CAAG,QAAd,CAAzB,CAAmD,CAACC,eAAe,CAAG,OAAnB,CAF9D,CAGI,IAAI,CAAEN,IAAI,CAAC9D,KAHf,CAGsB,KAAK,CAAE,MAAI,CAACK,KAAL,CAAWV,OAAX,CAAmBmE,IAAI,CAAC9D,KAAxB,CAH7B,CAII,QAAQ,CAAE,MAAI,CAACS,YAJnB,CAIiC,OAAO,CAAE,MAAI,CAACG,cAJ/C,CAI+D,OAAO,CAAE,MAAI,CAACC,WAJ7E,EADO,CAAR,CAOA,CAXA,CADK,CAAR,CAeA,CAlBiB,CAAlB,CAmBA,mBACC,4CACC,2BAAK,SAAS,CAAC,OAAf,eACC,6BAAO,OAAO,CAAC,cAAf,CAA8B,SAAS,CAAC,KAAxC,mBADD,cAEC,6BAAO,IAAI,CAAC,MAAZ,CAAmB,EAAE,CAAC,cAAtB,CAAqC,IAAI,CAAC,cAA1C,CAAyD,QAAQ,CAAE,KAAKC,gBAAxE,EAFD,CADD,cAKC,0BAAI,SAAS,CAAC,OAAd,EAAuB,KAAKT,KAAL,CAAWgD,KAAlC,CALD,cAMC,2BAAK,SAAS,CAAC,WAAf,eACC,4BAAM,QAAQ,CAAE,KAAK1C,YAArB,eACC,8CACC,iCACCgD,SADD,CADD,CADD,cAMC,2BAAK,SAAS,CAAC,QAAf,eACC,6BAAO,IAAI,CAAC,QAAZ,CAAqB,KAAK,CAAC,aAA3B,EADD,CAND,CADD,CAND,cAkBC,2BAAK,SAAS,CAAC,QAAf,eACC,6BAAI,KAAKtD,KAAL,CAAWiD,MAAf,CADD,CAlBD,CADD,CAwBA,C,gDAEWQ,I,CAAM,CACjB,MAAOA,CAAAA,IAAI,CAAC9D,KAAL,GAAe,EAAtB,CACA,C,6DAEmB,iBACnB,MAAOqE,CAAAA,KAAK,CAAC,gFAAiF,KAAKhE,KAAL,CAAWG,MAA7F,CACV,CAAC8D,IAAI,CAAE,SAAP,CADU,CAAL,CAENC,IAFM,CAED,SAAAC,QAAQ,QAAIA,CAAAA,QAAQ,CAACpB,IAAT,EAAJ,EAFP,EAGNmB,IAHM,CAGD,SAACnB,IAAD,CAAU,CACf,MAAI,CAAChC,QAAL,CAAc,CAACd,MAAM,CAAG8C,IAAI,CAAC9C,MAAf,CAAuBV,KAAK,CAAGwD,IAAI,CAACxD,KAApC,CAA2CyD,KAAK,CAAGD,IAAI,CAACC,KAAxD,CAA+DC,MAAM,CAAGF,IAAI,CAACE,MAA7E,CAAd,EACA,CALM,EAMNmB,KANM,CAMA,SAACC,KAAD,CAAW,CACjBC,OAAO,CAACD,KAAR,CAAcA,KAAd,EACA,CARM,CAAP,CASA,C,wBApLuBjF,KAAK,CAACmF,S,EAuL/B,cAAezE,CAAAA,UAAf","sourcesContent":["import React from 'react';\nimport './Spellfound.css';\n\nconst match = (letters, facit) => {\n\tvar m = true;\n\tfacit.map(f => {\n\t\tif (letters[f.model.toUpperCase()] && letters[f.model.toUpperCase()].toUpperCase() !== f.value.toUpperCase()) {\n\t\t\tm = false;\n\t\t}\n\t\treturn 0;\n\t})\n\treturn m;\n}\n\nclass Spellfound extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tletters : {}, facit : {},\n\t\t\tmatrix : [],\n\t\t\ttypeDown : false,\n\t\t\tpuzzle : props.puzzle\n\t\t};\n\n\t\tthis.handleChange = this.handleChange.bind(this);\n\t\tthis.handleSubmit = this.handleSubmit.bind(this);\n\t\tthis.handleArrowKey = this.handleArrowKey.bind(this);\n\t\tthis.handleFocus = this.handleFocus.bind(this);\n\t\tthis.handleFileSelect = this.handleFileSelect.bind(this);\n\t\tthis.loadJson = this.loadJson.bind(this);\n\t}\n\n\thandleChange(e) {\n\t\tif (e !== undefined) {\n\t\t\tlet upperCase = e.target.value.toUpperCase();\n\t\t\tthis.setState({\n\t\t\t\t[e.target.name] : upperCase\n\t\t\t});\n\t\t\tthis.state.letters[e.target.name] = upperCase;\n\t\t\tif (e.target.className.includes('rightdown')) {\n\t\t\t\tthis.setState({typeDown : true});\n\t\t\t\tthis.moveFocus(this.nextIdDown(e.target.id));\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (e.target.className.includes('downright')) {\n\t\t\t\tthis.setState({typeDown : false});\n\t\t\t\tthis.moveFocus(this.nextIdRight(e.target.id));\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (this.state.typeDown) {\n\t\t\t\tthis.moveFocus(this.nextIdDown(e.target.id));\n\t\t\t} else {\n\t\t\t\tthis.moveFocus(this.nextIdRight(e.target.id));\n\t\t\t}\n\t\t}\n\t}\n\n\tmoveFocus(nextid) {\n\t\tif (document.getElementById(nextid) !== null) {\n\t\t\tdocument.getElementById(nextid).focus();\n\t\t}\n\t}\n\n\tnextIdRight(id) {\n\t\treturn id.substr(0, 3) + (parseInt(id.substr(3, 2), 10) + 1).toString().padStart(2, \"0\");\n\t}\n\tnextIdLeft(id) {\n\t\treturn id.substr(0, 3) + (parseInt(id.substr(3, 2), 10) - 1).toString().padStart(2, \"0\");\n\t}\n\tnextIdUp(id) {\n\t\treturn id.substr(0, 1) + (parseInt(id.substr(1, 2), 10) - 1).toString().padStart(2, \"0\") + id.substr(3, 2);\n\t}\n\tnextIdDown(id) {\n\t\treturn id.substr(0, 1) + (parseInt(id.substr(1, 2), 10) + 1).toString().padStart(2, \"0\") + id.substr(3, 2);\n\t}\n\n\thandleArrowKey (e) {\n\t\tvar nextid;\n\t\tswitch (e.key) {\n\t\t\tcase 'ArrowUp':\n\t\t\t\tnextid = this.nextIdUp(e.target.id);\n\t\t\t\tthis.setState({typeDown : true});\n\t\t\t\tbreak;\n\t\t\tcase 'ArrowDown':\n\t\t\t\tnextid = this.nextIdDown(e.target.id);\n\t\t\t\tthis.setState({typeDown : true});\n\t\t\t\tbreak;\n\t\t\tcase 'ArrowLeft':\n\t\t\t\tnextid = this.nextIdLeft(e.target.id);\n\t\t\t\tthis.setState({typeDown : false});\n\t\t\t\tbreak;\n\t\t\tcase 'ArrowRight':\n\t\t\t\tnextid = this.nextIdRight(e.target.id);\n\t\t\t\tthis.setState({typeDown : false});\n\t\t\t\tbreak;\n\t\t}\n\t\tthis.moveFocus(nextid);\n\t};\n\n\thandleFileSelect(evt) {\n\t\tif (evt) {\n\t\t\tlet files = evt.target.files;\n\t\t\tif (!files.length) {\n\t\t\t\talert('No file select');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet file = files[0];\n\t\t\tlet reader = new FileReader();\n\t\t\tlet that = this;\n\t\t\treader.onload = function (e) {\n\t\t\t\tthat.loadJson(JSON.parse(e.target.result));\n\t\t\t};\n\t\t\treader.readAsText(file);\n\t\t}\n\t}\n\n\tloadJson(json) {\n\t\tthis.setState({matrix : json.matrix, facit : json.facit, title : json.title, legend : json.legend})\n\t}\n\n\thandleSubmit(event) {\n\t\tif (match(this.state.letters, this.state.facit)) {\n\t\t\talert('Correct!');\n\t\t} else {\n\t\t\talert('Needs more work!');\n\t\t}\n\t\tevent.preventDefault();\n\t}\n\n\thandleFocus(e) {\n\t\te.target.select();\n\t}\n\n\trender() {\n\t\tvar rowId = 0;\n\t\tconst matrixTab = this.state.matrix.map(rad => {\n\t\t\t++rowId;\n\t\t\tvar colId = 0;\n\t\t\treturn (<tr key={rowId}>\n\t\t\t\t\t{rad.map(cell => {\n\t\t\t\t\t\t++colId;\n\t\t\t\t\t\tlet sqrId = \"i\" + rowId.toString().padStart(2, \"0\") + colId.toString().padStart(2, \"0\");\n\t\t\t\t\t\tlet sqrClass = \"sqr \" + ((cell.class !== undefined) ? cell.class : \"\");\n\t\t\t\t\t\treturn (<td key={sqrId}>\n\t\t\t\t\t\t\t<input id={sqrId}\n\t\t\t\t\t\t\t\t\t\t disabled={this.getDisabled(cell)} className={sqrClass} type=\"text\" size=\"1\" maxLength=\"1\" required\n\t\t\t\t\t\t\t\t\t\t style={this.getDisabled(cell) ? {visibility : 'hidden'} : {backgroundColor : 'ivory'}}\n\t\t\t\t\t\t\t\t\t\t name={cell.model} value={this.state.letters[cell.model]}\n\t\t\t\t\t\t\t\t\t\t onChange={this.handleChange} onKeyUp={this.handleArrowKey} onFocus={this.handleFocus}/>\n\t\t\t\t\t\t</td>);\n\t\t\t\t\t})}\n\t\t\t\t</tr>\n\t\t\t)\n\t\t})\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<div className=\"title\">\n\t\t\t\t\t<label htmlFor=\"inputfilnamn\" className=\"btn\">LÃ¤s in:&nbsp;</label>\n\t\t\t\t\t<input type=\"file\" id=\"inputfilnamn\" name=\"inputfilnamn\" onChange={this.handleFileSelect}/>\n\t\t\t\t</div>\n\t\t\t\t<h2 className=\"title\">{this.state.title}</h2>\n\t\t\t\t<div className=\"component\">\n\t\t\t\t\t<form onSubmit={this.handleSubmit}>\n\t\t\t\t\t\t<table>\n\t\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t{matrixTab}\n\t\t\t\t\t\t\t</tbody>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t\t<div className=\"verify\">\n\t\t\t\t\t\t\t<input type=\"submit\" value=\"Kontrollera\"/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</form>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"legend\">\n\t\t\t\t\t<p>{this.state.legend}</p>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t)\n\t}\n\n\tgetDisabled(cell) {\n\t\treturn cell.model === '';\n\t}\n\n\tcomponentDidMount() {\n\t\treturn fetch('http://spellbuildboot-env.eba-vhu9appg.eu-north-1.elasticbeanstalk.com/store/'+ this.state.puzzle\n\t\t, {mode: 'no-cors'})\n\t\t.then(response => response.json())\n\t\t.then((json) => {\n\t\t\tthis.setState({matrix : json.matrix, facit : json.facit, title : json.title, legend : json.legend})\n\t\t})\n\t\t.catch((error) => {\n\t\t\tconsole.error(error)\n\t\t})\n\t}\n}\n\nexport default Spellfound;\n"]},"metadata":{},"sourceType":"module"}